# Slack Notification Examples

This document shows examples of Slack notifications generated by the automated workflow.

## Example 1: Shell Configuration Feature

**Trigger:** Merge adding shell configuration system to master

**Changelog Addition:**
```markdown
### Added
- Added Sparkdock shell configuration system with modern CLI tools (eza, bat, ripgrep, fd, zoxide, fzf, starship, thefuck, chafa)
- Added new sjust commands for shell management: `sjust shell-enable`, `sjust shell-disable`, `sjust shell-info`
- Added seamless integration with existing oh-my-zsh/starship installations
```

**Generated Notification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ New Sparkdock Features                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ Sparkdock now includes a modern shell configuration     â”‚
â”‚ system with smart aliases, conditional tool loading     â”‚
â”‚ (eza, bat, fzf, starship), and seamless oh-my-zsh      â”‚
â”‚ integration. New sjust commands let you enable/disable  â”‚
â”‚ features and view comprehensive shell status.           â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Commit: a1b2c3d by sparkfabrik                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example 2: HTTP Proxy Enhancement

**Trigger:** Merge adding HTTP proxy SSL certificate support

**Changelog Addition:**
```markdown
### Added
- Added automatic SSL certificate generation for local development with mkcert integration
- Added DNS resolver configuration for .loc domains
- Added Traefik monitoring dashboard with Grafana and Prometheus
```

**Generated Notification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ New Sparkdock Features                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ The HTTP proxy now automatically generates SSL          â”‚
â”‚ certificates for local development and configures DNS   â”‚
â”‚ resolution for .loc domains. Access monitoring          â”‚
â”‚ dashboards through the new Traefik integration.         â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Commit: b4c5d6e by sparkfabrik                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example 3: No Notification (Bug Fixes Only)

**Trigger:** Merge with only bug fixes

**Changelog Addition:**
```markdown
### Fixed
- Fixed Python interpreter not found error by implementing ensure_python3() function
- Fixed sjust zsh completion file ownership issue
- Fixed eza alias to display group ownership by default
```

**Generated Notification:**
```
(No notification sent - Claude determines these are maintenance fixes, not new features)
```

## Slack Block Structure

The notifications use Slack's Block Kit for rich formatting:

```json
{
  "text": "ğŸ‰ New Sparkdock features merged to master!",
  "blocks": [
    {
      "type": "header",
      "text": {
        "type": "plain_text",
        "text": "ğŸ‰ New Sparkdock Features",
        "emoji": true
      }
    },
    {
      "type": "section",
      "text": {
        "type": "mrkdwn",
        "text": "<Claude's generated message>"
      }
    },
    {
      "type": "context",
      "elements": [
        {
          "type": "mrkdwn",
          "text": "*Commit:* <https://github.com/sparkfabrik/sparkdock/commit/abc123|abc123> by author"
        }
      ]
    }
  ]
}
```

## Message Generation Guidelines

Claude is instructed to:
- Keep messages concise (2-4 sentences maximum)
- Focus on user-facing benefits, not implementation details
- Use friendly, conversational tone
- Highlight the most impactful features
- Avoid technical jargon when possible
- Not include markdown headers or excessive formatting

## Notification Decision Logic

The workflow sends notifications when:
- âœ… New significant user-facing features are added
- âœ… Major enhancements to existing functionality
- âœ… New commands or capabilities available to users
- âœ… Important integrations or tool additions

The workflow skips notifications for:
- âŒ Minor bug fixes
- âŒ Internal refactoring
- âŒ Documentation-only changes
- âŒ Build/CI configuration changes
- âŒ Dependency updates (unless they enable new features)

## Testing Notifications

To test the notification end-to-end:

```bash
# Test mode (requires both ANTHROPIC_API_KEY and SLACK_WEBHOOK_URL)
export ANTHROPIC_API_KEY="your-key"
export SLACK_WEBHOOK_URL="your-webhook-url"
python3 src/slack-notify/notify-slack-on-merge.py --test
```

The test mode will:
1. Use sample changelog diffs (no git required)
2. Call Claude API to analyze each diff
3. Generate notification messages
4. Send actual notifications to Slack

This allows you to:
- Test the Claude AI integration end-to-end
- Verify message generation
- Validate actual Slack notification delivery
- Use sample diffs without needing git history

## Example Notification

When significant features are detected, the notification appears in Slack like this:

```
ğŸš€ New Sparkdock Release

This release brings significant infrastructure improvements and expanded development environment options:

â€¢ Automated Slack notifications for feature releases - development team announcements are now streamlined through automated notifications for significant changes merged to the master branch

â€¢ Lima container environment with Docker Desktop replacement support - developers now have a lightweight alternative to Docker Desktop that reduces resource consumption while maintaining full container functionality

â€¢ New shell enhancement system with eza, starship, and fzf integration - enhanced command-line productivity through modern tools including better file listings, an improved prompt, and powerful fuzzy finding capabilities

Commit: abc1234 by sparkfabrik
```

## Customizing Messages

To adjust the notification style or content, edit the prompt in `src/slack-notify/prompts/analyze-changelog.txt`:

The prompt file contains guidelines for Claude AI to analyze changelog diffs and generate user-friendly messages. You can modify:
- Message length (currently 2-4 sentences)
- Tone and style preferences
- Feature filtering criteria
- Focus areas (user-facing benefits vs. technical details)

## Monitoring

Check workflow runs:
- Go to: https://github.com/sparkfabrik/sparkdock/actions
- Filter by: "Notify Slack on Master Merge"
- View logs to see:
  - Changelog diff extracted
  - Claude's analysis decision
  - Generated message
  - Slack API response

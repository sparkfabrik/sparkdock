# Slack Notification Examples

This document shows examples of Slack notifications generated by the automated workflow.

## Example 1: Shell Configuration Feature

**Trigger:** Merge adding shell configuration system to master

**Changelog Addition:**
```markdown
### Added
- Added Sparkdock shell configuration system with modern CLI tools (eza, bat, ripgrep, fd, zoxide, fzf, starship, thefuck, chafa)
- Added new sjust commands for shell management: `sjust shell-enable`, `sjust shell-disable`, `sjust shell-info`
- Added seamless integration with existing oh-my-zsh/starship installations
```

**Generated Notification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ New Sparkdock Features                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ Sparkdock now includes a modern shell configuration     â”‚
â”‚ system with smart aliases, conditional tool loading     â”‚
â”‚ (eza, bat, fzf, starship), and seamless oh-my-zsh      â”‚
â”‚ integration. New sjust commands let you enable/disable  â”‚
â”‚ features and view comprehensive shell status.           â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Commit: a1b2c3d by sparkfabrik                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example 2: HTTP Proxy Enhancement

**Trigger:** Merge adding HTTP proxy SSL certificate support

**Changelog Addition:**
```markdown
### Added
- Added automatic SSL certificate generation for local development with mkcert integration
- Added DNS resolver configuration for .loc domains
- Added Traefik monitoring dashboard with Grafana and Prometheus
```

**Generated Notification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ New Sparkdock Features                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ The HTTP proxy now automatically generates SSL          â”‚
â”‚ certificates for local development and configures DNS   â”‚
â”‚ resolution for .loc domains. Access monitoring          â”‚
â”‚ dashboards through the new Traefik integration.         â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Commit: b4c5d6e by sparkfabrik                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example 3: No Notification (Bug Fixes Only)

**Trigger:** Merge with only bug fixes

**Changelog Addition:**
```markdown
### Fixed
- Fixed Python interpreter not found error by implementing ensure_python3() function
- Fixed sjust zsh completion file ownership issue
- Fixed eza alias to display group ownership by default
```

**Generated Notification:**
```
(No notification sent - Claude determines these are maintenance fixes, not new features)
```

## Slack Block Structure

The notifications use Slack's Block Kit for rich formatting:

```json
{
  "text": "ğŸ‰ New Sparkdock features merged to master!",
  "blocks": [
    {
      "type": "header",
      "text": {
        "type": "plain_text",
        "text": "ğŸ‰ New Sparkdock Features",
        "emoji": true
      }
    },
    {
      "type": "section",
      "text": {
        "type": "mrkdwn",
        "text": "<Claude's generated message>"
      }
    },
    {
      "type": "context",
      "elements": [
        {
          "type": "mrkdwn",
          "text": "*Commit:* <https://github.com/sparkfabrik/sparkdock/commit/abc123|abc123> by author"
        }
      ]
    }
  ]
}
```

## Message Generation Guidelines

Claude is instructed to:
- Keep messages concise (2-4 sentences maximum)
- Focus on user-facing benefits, not implementation details
- Use friendly, conversational tone
- Highlight the most impactful features
- Avoid technical jargon when possible
- Not include markdown headers or excessive formatting

## Notification Decision Logic

The workflow sends notifications when:
- âœ… New significant user-facing features are added
- âœ… Major enhancements to existing functionality
- âœ… New commands or capabilities available to users
- âœ… Important integrations or tool additions

The workflow skips notifications for:
- âŒ Minor bug fixes
- âŒ Internal refactoring
- âŒ Documentation-only changes
- âŒ Build/CI configuration changes
- âŒ Dependency updates (unless they enable new features)

## Testing Notifications

To test notification generation without sending to Slack:

```bash
# Test structure and logic
./bin/test-slack-workflow-structure.sh

# Test with Claude API (requires ANTHROPIC_API_KEY)
export ANTHROPIC_API_KEY="your-key"
./bin/test-slack-notification.sh
```

To send a real test notification:

```bash
# Set both required environment variables
export ANTHROPIC_API_KEY="your-anthropic-key"
export SLACK_WEBHOOK_URL="your-slack-webhook-url"

# Run the integration test
./bin/test-slack-notification.sh
```

The integration test will:
1. Generate a sample changelog diff
2. Call Claude to analyze it
3. Create a Slack message
4. Send it to your webhook URL

## Customizing Messages

To adjust the notification style or content, edit the prompt in `.github/workflows/notify-slack-on-merge.yml`:

```yaml
- name: Analyze changelog with Claude
  env:
    ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
  run: |
    PROMPT="You are analyzing a CHANGELOG.md diff...

    # Modify these guidelines:
    - Keep it concise (2-4 sentences maximum)
    - Focus on user-facing benefits
    ..."
```

## Monitoring

Check workflow runs:
- Go to: https://github.com/sparkfabrik/sparkdock/actions
- Filter by: "Notify Slack on Master Merge"
- View logs to see:
  - Changelog diff extracted
  - Claude's analysis decision
  - Generated message
  - Slack API response
